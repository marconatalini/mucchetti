framework:
    workflows:
        permit_request:
            type: 'state_machine'
            marking_store:
                type: 'method'
                property: 'status'
            # The "supports" option is useful only if you are using Twig functions ('workflow_*')
            supports:
                - App\Entity\Permit
            initial_marking: start
            places:
                - start
                - submitted
                - review
                - approved
                - registered
                - deleted
            transitions:
                delete:
                    guard: "user == subject.getEmployee()"
                    from: [start, review]
                    to: delete
                submit:
                    guard: "user == subject.getEmployee()"
                    from: [start, review]
                    to: submitted
                approve:
                    guard: "is_granted('ROLE_BOSS') and user != subject.getEmployee()"
                    from: submitted
                    to: approved
                reject:
                    guard: "is_granted('ROLE_BOSS') and user != subject.getEmployee()"
                    from: submitted
                    to: review
                close:
                    guard: "is_granted('ROLE_STAFF')"
                    from: approved
                    to: registered
                
